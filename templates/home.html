{% extends 'app.html' %}

{% block css_linking %}
<link href="/static/home.css" rel="stylesheet"> {% endblock %}
{% block title %} Home {% endblock %}
{% block heading1 %} Home {% endblock %}
{% block homepage_pie_chart %}
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
    google.charts.load("current", { packages: ["corechart"] });
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
        var data = google.visualization.arrayToDataTable([
            {% for key, value in data.items() %}
    {% if value is string %}
    ['{{ key }}', '{{ value }}'],
        {% else %}
    ['{{ key }}', {{ value }}],
        {% endif %}
    {% endfor %}
        ]);


    let options = {
        pieHole: 0.5
    };

    let chart = new google.visualization.PieChart(document.getElementById('piechart_3d'));
    chart.draw(data, options);
    }
</script>
{% endblock %}

{% block main_content %}
<section class="total-expense">
    <!-- Display for total user expense goes here -->
    <p>Total: ${{ total_expense }}</p>
</section>

<section class="pie-chart-display">
    <!-- Display for pie chart goes here -->
    <div style=" width: 100%; overflow: hidden;">
        <div id="piechart_3d" style="width: 300px; height: 167px; overflow: hidden;"></div>
    </div>
</section>

<section class="expense-cards">
    <!-- List of current existing user expenses -->
    <table>
        <tr>
            <th>Date</th>
            <th>Name</th>
            <th>Category</th>
            <th>Amount</th>
        </tr>
        {% for user_expense in user_expenses %}
        <tr>
            <td>
                {{ user_expense.date }}
            </td>
            <td>
                {{ user_expense.name }}
            </td>
            <td>
                {{ user_expense.category }}
            </td>
            <td class="expense-amount">
                ${{ user_expense.amount }}
                <div class="home-icons">
                    <span id="edit-expense"><a
                            href="{{ url_for('get_expense', eid=user_expenses.index(user_expense)+1, uid=session.get('uid')) }}"><i
                                class="fa fa-pencil-square" aria-hidden="true"></i></a></span>
                    <span id="delete-expense"><a href="{{ url_for('homepage', uid=session.get('uid')) }}"><i
                                class="fa fa-trash" aria-hidden="true"></i></a></span>
                </div>
            </td>
        </tr>
        {% endfor %}
    </table>
</section>
{% endblock %}